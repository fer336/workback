{
  "active": true,
  "connections": {
    "Form Me1": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [],
        [
          {
            "node": "vars",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [],
        [
          {
            "node": "Send a text message1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "base64",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "Reaction1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "vars": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transcribir1": {
      "main": [
        [
          {
            "node": "Send a text message1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to File1": {
      "main": [
        [
          {
            "node": "Transcribir1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Datos": {
      "main": [
        [
          {
            "node": "Form Me1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "base64": {
      "main": [
        [
          {
            "node": "Convert to File1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Reaction": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "msg reply": {
      "main": [
        []
      ]
    },
    "Wait1": {
      "main": [
        [
          {
            "node": "Reaction",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-06-28T03:55:50.431Z",
  "id": "a8338uMCc4DrsgvE",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "TRANSCRIPCION AUDIOS - FER",
  "nodes": [
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "94746291-c0f3-44f3-b635-1fe696d7d74e",
              "leftValue": "={{ $json.body.data.key.fromMe }}",
              "rightValue": "false",
              "operator": {
                "type": "boolean",
                "operation": "false",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "90ab94cb-a529-4632-b22d-6847fcf5ffe9",
      "name": "Form Me1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -1200,
        96
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "41aafda0-2ad8-4a37-b160-1e7255bc75d5",
              "leftValue": "={{ $json.body.data.key.remoteJid.includes('@g.us')}}",
              "rightValue": "={{ $json.body.data.key.remoteJid.includes('@g.us')}}",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "3708abde-d556-4a06-8a36-ca6229ceb376",
      "name": "If1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -992,
        96
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "60065893-74f7-4b64-bc1a-d891202efa78",
                    "leftValue": "={{ $('Datos').item.json.body.data.messageType }}",
                    "rightValue": "imageMessage",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Imagem"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "0cb14635-2673-408e-86db-ce9e0373674b",
                    "leftValue": "={{ $('Datos').item.json.body.data.messageType }}",
                    "rightValue": "conversation",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Texto"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Datos').item.json.body.data.messageType }}",
                    "rightValue": "audioMessage",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "900368e1-63d9-419c-9dd3-20cd105a527d"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "√Åudio"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "eafea61d-45c4-4eb7-b7e5-ee91c4a6bfb9",
                    "leftValue": "={{ $json.msg.type }}",
                    "rightValue": "call",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "call"
            }
          ]
        },
        "options": {}
      },
      "id": "680be231-68f7-4f5d-9cab-4bf427b4fc9c",
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -560,
        -64
      ]
    },
    {
      "parameters": {
        "amount": 3
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -496,
        352
      ],
      "id": "caa97532-361b-4e02-a36b-42348768216e",
      "name": "Wait",
      "webhookId": "c5753ffd-3ac8-4fe0-a888-9999f106031b"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "56ef887f-a0eb-415a-b841-44fd8b61b1a8",
              "name": "msg.id",
              "value": "={{ $('Datos').item?.json?.body?.data?.messageId || $json.body.data['0'].id}}",
              "type": "string"
            },
            {
              "id": "740549d1-2ed9-49fd-9969-f3f69c5a8df2",
              "name": "msg.telefono",
              "value": "={{ $('Datos').item?.json?.body?.data?.key?.remoteJid || $json.body.data['0'].chatId}}",
              "type": "string"
            },
            {
              "id": "74a49e3c-159b-47a2-ae8b-54924cef3965",
              "name": "msg.type",
              "value": "={{ $('Datos').item?.json?.body?.data?.messageType || $json.body.type }}",
              "type": "string"
            },
            {
              "id": "1c6e95f3-9a56-4d4c-8db0-ffd1a56664f2",
              "name": "msg.audio",
              "value": "={{ ($json.body.data.fileBase64 || '').substring(($json.body.data.fileBase64 || '').indexOf(',') + 1) }}",
              "type": "string"
            },
            {
              "id": "6900b05f-3f95-479a-a763-2fbb75de7603",
              "name": "msg.status",
              "value": "={{ $json?.body?.data['0']?.status || $('Datos').first().json.body.data.msgContent.conversation }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -768,
        96
      ],
      "id": "70f08845-af73-4554-ad67-af1d8ebe43bb",
      "name": "vars"
    },
    {
      "parameters": {
        "resource": "audio",
        "operation": "transcribe",
        "options": {
          "language": "es",
          "temperature": 0.3
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        -1392,
        352
      ],
      "id": "37a96d85-acf0-444d-8ce1-ea935bdee244",
      "name": "Transcribir1",
      "credentials": {
        "openAiApi": {
          "id": "tpho37KNAAX388pI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "options": {
          "fileName": "=audio.ogg"
        }
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        -80,
        96
      ],
      "id": "485baf45-56c7-4854-9033-212631eec7bf",
      "name": "Convert to File1"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "f33",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1440,
        96
      ],
      "id": "f7f73b56-e060-4e2a-9e49-2cab239e708a",
      "name": "Datos",
      "webhookId": "9ba09d30-2eb8-4bdf-8785-2bfc45e3f63d"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "b7d210f0-6a18-456d-9e89-aa28f548b2a0",
              "name": "base64",
              "value": "={{ $json.msg.audio }}",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "id": "2d64bc91-211c-4768-9b35-765a69d2edf2",
      "name": "base64",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -320,
        96
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://us.api-wa.me/2522xaf8359c21b/message/reaction",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "accept",
              "value": "*/*"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "to",
              "value": "={{ $('vars').item.json.msg.telefono }}"
            },
            {
              "name": "text",
              "value": "=‚úçÔ∏è"
            },
            {
              "name": "msgId",
              "value": "={{ $json.data.key.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -736,
        352
      ],
      "id": "6988d132-7d01-43f1-a99c-9c041013e4f3",
      "name": "Reaction"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://us.api-wa.me/2522xaf8359c21b/message/{{ $('vars').item.json.msg.id }}/text",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "accept",
              "value": "*/*"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "to",
              "value": "={{ $('vars').item.json.msg.telefono }}"
            },
            {
              "name": "text",
              "value": "=_Transcripci√≥n_ üí≠\n\n{{ $json.text }}"
            },
            {
              "name": "msgId",
              "value": "={{ $('vars').item.json.msg.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1216,
        -80
      ],
      "id": "bf5c95de-ecd8-497c-bf8a-156385366161",
      "name": "msg reply"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://us.api-wa.me/2522xaf8359c21b/message/reaction",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "accept",
              "value": "*/*"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "to",
              "value": "={{ $('vars').item.json.msg.telefono }}"
            },
            {
              "name": "text",
              "value": "=üéØ"
            },
            {
              "name": "msgId",
              "value": "={{ $json.data.message.reactionMessage.key.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -112,
        352
      ],
      "id": "c6bbb6f4-9fb7-4f2e-a4bf-2e59cf8f58e7",
      "name": "Reaction1"
    },
    {
      "parameters": {
        "amount": 3
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -960,
        352
      ],
      "id": "a2e5044f-6953-4ef1-9786-735a2fec68f3",
      "name": "Wait1",
      "webhookId": "c5753ffd-3ac8-4fe0-a888-9999f106031b"
    },
    {
      "parameters": {
        "chatId": "164729397",
        "text": "={{ $('Datos').item.json.body.data.pushName }}: {{ $json?.text ||$json.msg.status  }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1168,
        352
      ],
      "id": "9d1dff04-359d-44a0-82b5-d4f0895e029e",
      "name": "Send a text message1",
      "webhookId": "86f792a6-5bf4-47da-b6ec-43e30195274e",
      "credentials": {
        "telegramApi": {
          "id": "9g3zPwxX46iLtGJa",
          "name": "Qeva AI"
        }
      }
    }
  ],
  "pinData": {
    "Datos": [
      {
        "json": {
          "headers": {
            "host": "n8nw.qeva.xyz",
            "user-agent": "axios/1.11.0",
            "content-length": "713",
            "accept": "application/json, text/plain, */*",
            "accept-encoding": "gzip, compress, deflate, br",
            "content-type": "application/json",
            "instance-key": "2522xaf8359c21b",
            "x-forwarded-for": "144.126.133.227",
            "x-forwarded-host": "n8nw.qeva.xyz",
            "x-forwarded-port": "443",
            "x-forwarded-proto": "https",
            "x-forwarded-server": "7697b68d06c2",
            "x-real-ip": "144.126.133.227"
          },
          "params": {},
          "query": {},
          "body": {
            "instance": "2522xaf8359c21b",
            "type": "message",
            "data": {
              "messageId": "0338B28D79F11A74A4D3416D79CE1E89",
              "jid": "5492254423359:97@s.whatsapp.net",
              "me": false,
              "isGroup": false,
              "remoteJid": "447453536046",
              "pushName": "Quena",
              "key": {
                "remoteJid": "447453536046@s.whatsapp.net",
                "fromMe": false,
                "id": "0338B28D79F11A74A4D3416D79CE1E89"
              },
              "messageType": "conversation",
              "msgContent": {
                "conversation": "Tengo ansiedad, no me encuentro bien",
                "messageContextInfo": {
                  "deviceListMetadata": {
                    "recipientKeyHash": "iVJZBUf9o9GNyA==",
                    "recipientTimestamp": "1753698939"
                  },
                  "deviceListMetadataVersion": 2,
                  "messageSecret": "PyH/FXpH20w5HyUKKuyocE6avdlSXqDiyF5PpAJGJ4w="
                }
              },
              "messageTimestamp": 1754386867,
              "source": "android",
              "broadcast": false,
              "isMedia": false
            }
          },
          "webhookUrl": "https://n8nw.qeva.xyz/webhook/f33",
          "executionMode": "production"
        }
      }
    ]
  },
  "settings": {
    "executionOrder": "v1",
    "errorWorkflow": "2kOn0Oz7c2uvczPK"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2025-08-05T09:54:24.024Z",
  "versionId": "2c329979-1026-41bf-b28d-56ccbc890246"
}