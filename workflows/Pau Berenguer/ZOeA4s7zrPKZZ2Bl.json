{
  "active": false,
  "connections": {
    "Extract from Excel": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract PDF Text": {
      "main": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Recursive Character Text Splitter": {
      "ai_textSplitter": [
        [
          {
            "node": "Default Data Loader",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI1": {
      "ai_embedding": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "File Created": {
      "main": [
        [
          {
            "node": "Datos Relevantes",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from Text File": {
      "main": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "File Updated": {
      "main": [
        [
          {
            "node": "Datos Relevantes #1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Delete Old Doc Rows": {
      "main": [
        [
          {
            "node": "Download File #2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader": {
      "ai_document": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Datos Relevantes": {
      "main": [
        [
          {
            "node": "Download File #1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download File #1": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download file": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Delete a file": {
      "main": [
        [
          {
            "node": "Download file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Summarize": {
      "main": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "Summarize",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Recursive Character Text Splitter1": {
      "ai_textSplitter": [
        [
          {
            "node": "Default Data Loader2",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "Datos Relevantes #1": {
      "main": [
        [
          {
            "node": "Delete Old Doc Rows",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download File #2": {
      "main": [
        [
          {
            "node": "Switch #1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Extract PDF Text",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Extract from Text File",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Extract from Excel",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Convertir a Doc",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Convertir a Doc",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Convertir a Doc",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Convertir a Doc",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch #1": {
      "main": [
        [
          {
            "node": "Extract PDF Text #1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Extract from Text File #1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Extract from Excel #1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Convertir a Doc #1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Convertir a Doc #1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Convertir a Doc #1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract PDF Text #1": {
      "main": [
        [
          {
            "node": "Supabase Vector Store #1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from Text File #1": {
      "main": [
        [
          {
            "node": "Supabase Vector Store #1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from Excel #1": {
      "main": [
        [
          {
            "node": "Aggregate #1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download file #1": {
      "main": [
        [
          {
            "node": "Switch #1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Delete a file #1": {
      "main": [
        [
          {
            "node": "Download file #1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader2": {
      "ai_document": [
        [
          {
            "node": "Supabase Vector Store #1",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI #1": {
      "ai_embedding": [
        [
          {
            "node": "Supabase Vector Store #1",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Summarize #1": {
      "main": [
        [
          {
            "node": "Supabase Vector Store #1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate #1": {
      "main": [
        [
          {
            "node": "Summarize #1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convertir a Doc": {
      "main": [
        [
          {
            "node": "Delete a file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convertir a Doc #1": {
      "main": [
        [
          {
            "node": "Delete a file #1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-07-09T17:48:48.650Z",
  "id": "ZOeA4s7zrPKZZ2Bl",
  "isArchived": false,
  "meta": null,
  "name": "RAG",
  "nodes": [
    {
      "parameters": {
        "operation": "pdf",
        "options": {}
      },
      "id": "ef3702a9-ab6d-4daa-b068-c3fb17d665ff",
      "name": "Extract PDF Text",
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        220,
        -40
      ]
    },
    {
      "parameters": {
        "operation": "xlsx",
        "options": {}
      },
      "id": "ac9a0575-8cde-43b2-bcd3-be07879cf2d2",
      "name": "Extract from Excel",
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        220,
        300
      ]
    },
    {
      "parameters": {
        "chunkOverlap": 100,
        "options": {
          "splitCode": "markdown"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
      "typeVersion": 1,
      "position": [
        1680,
        320
      ],
      "id": "6d480c38-cdc7-4f92-9adb-cf058f4deb39",
      "name": "Recursive Character Text Splitter"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.1,
      "position": [
        1260,
        320
      ],
      "id": "a56735e1-a933-463a-a6d7-bb3195727c05",
      "name": "Embeddings OpenAI1"
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "triggerOn": "specificFolder",
        "folderToWatch": {
          "__rl": true,
          "value": "1OGib9pfjTyyLG61vZbtFKyfbabr1T0HK",
          "mode": "list",
          "cachedResultName": "RAG",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1OGib9pfjTyyLG61vZbtFKyfbabr1T0HK"
        },
        "event": "fileCreated",
        "options": {}
      },
      "id": "50183857-89a6-428c-b2f4-bdb75f9208f1",
      "name": "File Created",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "typeVersion": 1,
      "position": [
        -980,
        320
      ]
    },
    {
      "parameters": {
        "operation": "text",
        "options": {}
      },
      "id": "8fd1555a-9166-4dd3-9a81-593a7b6caad7",
      "name": "Extract from Text File",
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        220,
        120
      ],
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "operation": "delete",
        "tableId": "rag_chunks",
        "filterType": "string",
        "filterString": "=metadata->>file_id=like.*{{ $('Datos Relevantes #1').item.json.file_id }}*"
      },
      "id": "421a247c-dac3-4277-9d97-599fd518c9ca",
      "name": "Delete Old Doc Rows",
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -440,
        1420
      ],
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "triggerOn": "specificFolder",
        "folderToWatch": {
          "__rl": true,
          "value": "1OGib9pfjTyyLG61vZbtFKyfbabr1T0HK",
          "mode": "list",
          "cachedResultName": "RAG",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1OGib9pfjTyyLG61vZbtFKyfbabr1T0HK"
        },
        "event": "fileUpdated",
        "options": {}
      },
      "id": "df82a886-5a11-451d-bdb0-d99c77393349",
      "name": "File Updated",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "typeVersion": 1,
      "position": [
        -960,
        1420
      ]
    },
    {
      "parameters": {
        "content": "## Base de Datos",
        "height": 240,
        "width": 420,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1200,
        -60
      ],
      "typeVersion": 1,
      "id": "603ede94-2818-44f4-9441-c74a53353bb6",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## 🛠️Cerebro/Herramientas\n",
        "height": 240,
        "width": 620,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1200,
        240
      ],
      "typeVersion": 1,
      "id": "d262111b-7a08-47a8-a3a5-10cca2985776",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "jsonMode": "expressionData",
        "jsonData": "={{ $json.data || $json.text || $json.concatenated_data }}",
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "=file_id",
                "value": "={{ $('Datos Relevantes').item.json.file_id }}"
              },
              {
                "name": "=version",
                "value": "v1"
              },
              {
                "name": "=creator",
                "value": "={{ $('File Created').item.json.owners[0].displayName }}"
              },
              {
                "name": "=created_at",
                "value": "={{ $('File Created').item.json.createdTime }}"
              },
              {
                "name": "last_modified",
                "value": "={{ $('File Created').item.json.modifiedTime }}"
              },
              {
                "name": "folder_path",
                "value": "projects"
              },
              {
                "name": "file_name",
                "value": "={{ $('File Created').item.json.name }}"
              },
              {
                "name": "file_extension",
                "value": "={{ $('File Created').item.json.mimeType }}"
              }
            ]
          }
        }
      },
      "id": "5a8ecee5-36da-41ea-8339-69411195fd88",
      "name": "Default Data Loader",
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1,
      "position": [
        1400,
        320
      ]
    },
    {
      "parameters": {
        "content": "## Resumir\n\n",
        "height": 240,
        "width": 300
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        840,
        240
      ],
      "typeVersion": 1,
      "id": "c26d81ad-938c-4dfc-b73a-76139a75a6d2",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "content": "## Agrupar\n",
        "height": 240,
        "width": 300
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        480,
        240
      ],
      "typeVersion": 1,
      "id": "27a86ae4-135f-4ed9-9160-3e2cd2731d5b",
      "name": "Sticky Note12"
    },
    {
      "parameters": {
        "content": "## 🛠️ Switch",
        "height": 480,
        "width": 300,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -240,
        140
      ],
      "typeVersion": 1,
      "id": "ac1e24d4-e59b-4d06-af72-969baa0ac075",
      "name": "Sticky Note13"
    },
    {
      "parameters": {
        "content": "## 🚀 Transformadores\n\n",
        "height": 620,
        "width": 300,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        120,
        -120
      ],
      "typeVersion": 1,
      "id": "c0ae8afd-7d2a-42d7-8bf5-195663c2f474",
      "name": "Sticky Note14"
    },
    {
      "parameters": {
        "content": "## 🏁 Trigger Google drive",
        "height": 260,
        "width": 220
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1040,
        240
      ],
      "typeVersion": 1,
      "id": "b574ebed-36b1-4480-bc60-419480f02df5",
      "name": "Sticky Note7"
    },
    {
      "parameters": {
        "content": "## 📚 Descarga de archivos",
        "height": 260
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -540,
        240
      ],
      "typeVersion": 1,
      "id": "ae75851f-d2dd-4d7b-aeae-3bc925c55f1a",
      "name": "Sticky Note16"
    },
    {
      "parameters": {
        "content": "## Descarga documento Word\n\n\n\n",
        "height": 280,
        "width": 720,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        120,
        560
      ],
      "typeVersion": 1,
      "id": "5ef310a7-2ef0-4f4f-9e74-4fa6f1ada797",
      "name": "Sticky Note17"
    },
    {
      "parameters": {
        "content": "## 🤯 Filtrador",
        "height": 260,
        "width": 150
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -760,
        240
      ],
      "typeVersion": 1,
      "id": "c9023a4f-e2e2-4804-a18a-277c765a1271",
      "name": "Sticky Note15"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "10646eae-ae46-4327-a4dc-9987c2d76173",
              "name": "file_id",
              "value": "={{ $('File Created').item.json.id }}",
              "type": "string"
            },
            {
              "id": "f4536df5-d0b1-4392-bf17-b8137fb31a44",
              "name": "file_type",
              "value": "={{ $('File Created').item.json.mimeType }}{{ $json.mimeType }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "ee570225-cf5c-476b-b6ef-f7d3b0bcdaa2",
      "name": "Datos Relevantes",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -740,
        320
      ]
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "={{ $('Datos Relevantes').item.json.file_id }}",
          "mode": "id"
        },
        "options": {
          "googleFileConversion": {
            "conversion": {
              "docsToFormat": "text/plain"
            }
          }
        }
      },
      "id": "53baf9f4-5338-4b68-a989-efcedc86b20b",
      "name": "Download File #1",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -460,
        320
      ],
      "executeOnce": true
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "={{ $('Convertir a Doc').item.json.id }}",
          "mode": "id"
        },
        "options": {
          "googleFileConversion": {
            "conversion": {
              "docsToFormat": "application/pdf"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        640,
        640
      ],
      "id": "bd516e79-c4e3-462b-bbd9-ef87efb39ea5",
      "name": "Download file"
    },
    {
      "parameters": {
        "operation": "deleteFile",
        "fileId": {
          "__rl": true,
          "value": "={{ $('Download File #1').item.json.file_id }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        460,
        640
      ],
      "id": "5c152ee1-14bf-4192-b9c4-4fb61732e128",
      "name": "Delete a file"
    },
    {
      "parameters": {
        "fieldsToSummarize": {
          "values": [
            {
              "aggregation": "concatenate",
              "field": "data"
            }
          ]
        },
        "options": {}
      },
      "id": "3b554925-8c2e-4583-a0c6-0ae9dd384524",
      "name": "Summarize",
      "type": "n8n-nodes-base.summarize",
      "typeVersion": 1,
      "position": [
        920,
        320
      ]
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "id": "ab90f1ef-a7de-4b17-9b3f-bad9fcac2fb3",
      "name": "Aggregate",
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        580,
        320
      ]
    },
    {
      "parameters": {
        "chunkOverlap": 100,
        "options": {
          "splitCode": "markdown"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
      "typeVersion": 1,
      "position": [
        2020,
        1420
      ],
      "id": "e31df86c-33f8-4218-b38a-e221ee7b1432",
      "name": "Recursive Character Text Splitter1"
    },
    {
      "parameters": {
        "content": "## Base de Datos",
        "height": 240,
        "width": 420,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1540,
        1040
      ],
      "typeVersion": 1,
      "id": "21bb4454-593a-4ebc-8bc0-30fdeb93c19e",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "## 🛠️Cerebro/Herramientas\n",
        "height": 240,
        "width": 620,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1540,
        1340
      ],
      "typeVersion": 1,
      "id": "43f8b09b-0e23-497a-9d26-2e3af2b6d6f1",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "## Resumir\n\n",
        "height": 240,
        "width": 300
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1180,
        1340
      ],
      "typeVersion": 1,
      "id": "f1720520-b78a-4583-b48a-1ccc2a1f1473",
      "name": "Sticky Note8"
    },
    {
      "parameters": {
        "content": "## Agrupar\n",
        "height": 240,
        "width": 300
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        820,
        1340
      ],
      "typeVersion": 1,
      "id": "68fa5236-e0a7-4b33-acc1-5c6ab7b99e25",
      "name": "Sticky Note18"
    },
    {
      "parameters": {
        "content": "## 🚀 Transformadores\n\n",
        "height": 620,
        "width": 300,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        460,
        980
      ],
      "typeVersion": 1,
      "id": "afe0bcd8-00d6-4d7c-9b83-59082fdec1a1",
      "name": "Sticky Note19"
    },
    {
      "parameters": {
        "content": "## Descarga documento Word\n\n\n\n",
        "height": 280,
        "width": 720,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        460,
        1660
      ],
      "typeVersion": 1,
      "id": "cc235c42-b9c5-4a7f-94d2-c698bd2602bd",
      "name": "Sticky Note20"
    },
    {
      "parameters": {
        "content": "## 📚 Descarga de archivos",
        "height": 260
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -200,
        1340
      ],
      "typeVersion": 1,
      "id": "fbdbae32-97f3-4cce-977d-11f37fbcade8",
      "name": "Sticky Note21"
    },
    {
      "parameters": {
        "content": "## 🛠️ Switch",
        "height": 480,
        "width": 300,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        100,
        1240
      ],
      "typeVersion": 1,
      "id": "8d2b08e7-bfac-442a-b7ef-8e23589ac791",
      "name": "Sticky Note22"
    },
    {
      "parameters": {
        "content": "## 🏁 Trigger Google drive",
        "height": 260,
        "width": 220
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1020,
        1340
      ],
      "typeVersion": 1,
      "id": "d4402524-a4e2-4279-b763-1ca1891a66a1",
      "name": "Sticky Note9"
    },
    {
      "parameters": {
        "content": "## 🤯 Filtrador",
        "height": 260,
        "width": 150
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -740,
        1340
      ],
      "typeVersion": 1,
      "id": "22cba3c2-890a-4770-926e-175c3f57183e",
      "name": "Sticky Note23"
    },
    {
      "parameters": {
        "content": "## 🗑️ Eliminar Datos",
        "height": 260,
        "width": 250
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -520,
        1340
      ],
      "typeVersion": 1,
      "id": "270fd5e8-7239-4493-8aaf-00145dd5754f",
      "name": "Sticky Note24"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "10646eae-ae46-4327-a4dc-9987c2d76173",
              "name": "file_id",
              "value": "={{ $('File Updated').item.json.id }}",
              "type": "string"
            },
            {
              "id": "f4536df5-d0b1-4392-bf17-b8137fb31a44",
              "name": "file_type",
              "value": "={{ $('File Updated').item.json.mimeType }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "6ce1c379-a441-46e4-ab14-9d97f6329865",
      "name": "Datos Relevantes #1",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -720,
        1420
      ]
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "={{ $('Datos Relevantes #1').item.json.file_id }}",
          "mode": "id"
        },
        "options": {
          "googleFileConversion": {
            "conversion": {
              "docsToFormat": "text/plain"
            }
          }
        }
      },
      "id": "e47d7383-1946-4fe2-b6a7-08fbdc60838d",
      "name": "Download File #2",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -120,
        1420
      ],
      "executeOnce": true
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.file_type }}",
                    "rightValue": "application/pdf",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "78d597d7-d11b-4539-8e0b-d64693ab7a16"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "PDF"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "id": "fc193b06-363b-4699-a97d-e5a850138b0e",
                    "leftValue": "={{ $json.file_type }}",
                    "rightValue": "application/vnd.google-apps.document",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Text"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "id": "2ae7faa7-a936-4621-a680-60c512163034",
                    "leftValue": "={{ $json.file_type }}",
                    "rightValue": "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Excel"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "id": "7ddfa924-1c26-4ee3-9890-5c9d2b96717a",
                    "leftValue": "={{ $json.file_type }}",
                    "rightValue": "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Docs #1"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "id": "f53caf8b-7a8f-4d1e-98f4-deaf0e0171f0",
                    "leftValue": "={{ $json.file_type }}",
                    "rightValue": "application/msword",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Docs #2"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "id": "cd9ca627-d00d-4c30-903a-41f603c8e36f",
                    "leftValue": "={{ $json.file_type }}",
                    "rightValue": "application/vnd.ms-word",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Docs #3"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "id": "9d386a3c-5e5d-4cb0-aae5-2fb95dcad82f",
                    "leftValue": "={{ $json.file_type }}",
                    "rightValue": "application/mswordapplication/msword",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Docs #3"
            }
          ]
        },
        "options": {
          "fallbackOutput": 2
        }
      },
      "id": "af1e0e04-6346-4cea-81cb-b892e3410b33",
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [
        -160,
        260
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.metadata.file_extension }}",
                    "rightValue": "application/pdf",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "78d597d7-d11b-4539-8e0b-d64693ab7a16"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "PDF"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "id": "fc193b06-363b-4699-a97d-e5a850138b0e",
                    "leftValue": "={{ $json.metadata.file_extension }}",
                    "rightValue": "application/vnd.google-apps.document",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Text"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "id": "2ae7faa7-a936-4621-a680-60c512163034",
                    "leftValue": "={{ $json.metadata.file_extension }}",
                    "rightValue": "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Excel"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "id": "7ddfa924-1c26-4ee3-9890-5c9d2b96717a",
                    "leftValue": "={{ $json.metadata.file_extension }}",
                    "rightValue": "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Docs #1"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "id": "f53caf8b-7a8f-4d1e-98f4-deaf0e0171f0",
                    "leftValue": "={{ $json.metadata.file_extension }}",
                    "rightValue": "application/msword",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Docs #2"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "id": "cd9ca627-d00d-4c30-903a-41f603c8e36f",
                    "leftValue": "={{ $json.metadata.file_extension }}",
                    "rightValue": "application/vnd.ms-word",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Docs #3"
            }
          ]
        },
        "options": {
          "fallbackOutput": 2
        }
      },
      "id": "189d0d7d-958f-407f-9162-90cd4fdbe0d8",
      "name": "Switch #1",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [
        180,
        1360
      ]
    },
    {
      "parameters": {
        "operation": "pdf",
        "options": {}
      },
      "id": "6e548fb9-a3d4-4dc4-8595-c7237a84fab5",
      "name": "Extract PDF Text #1",
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        560,
        1060
      ]
    },
    {
      "parameters": {
        "operation": "text",
        "options": {}
      },
      "id": "b7e7e56e-43f4-4cb4-9170-fc213187ffa8",
      "name": "Extract from Text File #1",
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        560,
        1220
      ],
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "operation": "xlsx",
        "options": {}
      },
      "id": "e58ca9b7-e85b-476c-8ee8-3cfa0c8b0a5e",
      "name": "Extract from Excel #1",
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        560,
        1400
      ]
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "={{ $('Convertir a Doc #1').item.json.id }}",
          "mode": "id"
        },
        "options": {
          "googleFileConversion": {
            "conversion": {
              "docsToFormat": "application/pdf"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        980,
        1740
      ],
      "id": "7b86dd9f-a931-478a-b09b-fb9ba275dc3a",
      "name": "Download file #1"
    },
    {
      "parameters": {
        "operation": "deleteFile",
        "fileId": {
          "__rl": true,
          "value": "={{ $('Loop #1').item.json.file_id }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        800,
        1740
      ],
      "id": "792059e3-0ca4-4c23-a6a8-1699ff98a3f4",
      "name": "Delete a file #1"
    },
    {
      "parameters": {
        "jsonMode": "expressionData",
        "jsonData": "={{ $json.data || $json.text || $json.concatenated_data }}",
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "=file_id",
                "value": "={{ $('Datos Relevantes #1').item.json.file_id }}"
              },
              {
                "name": "=version",
                "value": "v1"
              },
              {
                "name": "=creator",
                "value": "={{ $('File Updated').item.json.owners[0].displayName }}"
              },
              {
                "name": "=created_at",
                "value": "={{ $('File Updated').item.json.createdTime }}"
              },
              {
                "name": "last_modified",
                "value": "={{ $('File Updated').item.json.modifiedTime }}"
              },
              {
                "name": "folder_path",
                "value": "projects"
              },
              {
                "name": "file_name",
                "value": "={{ $('File Updated').item.json.name }}"
              },
              {
                "name": "file_extension",
                "value": "={{ $('File Updated').item.json.mimeType }}"
              }
            ]
          }
        }
      },
      "id": "6828525a-e4a6-47ca-9779-27fec41a1e9f",
      "name": "Default Data Loader2",
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1,
      "position": [
        1720,
        1420
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.1,
      "position": [
        1600,
        1420
      ],
      "id": "66d41bef-6d25-40a3-bc41-80609892dd73",
      "name": "Embeddings OpenAI #1"
    },
    {
      "parameters": {
        "mode": "insert",
        "tableName": {
          "__rl": true,
          "value": "rag_chunks",
          "mode": "list",
          "cachedResultName": "rag_chunks"
        },
        "options": {
          "queryName": "match_documents"
        }
      },
      "id": "71b69972-1b37-4c89-afff-9e539137a5f8",
      "name": "Supabase Vector Store #1",
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1,
      "position": [
        1580,
        1140
      ]
    },
    {
      "parameters": {
        "mode": "insert",
        "tableName": {
          "__rl": true,
          "value": "rag_chunks",
          "mode": "list",
          "cachedResultName": "rag_chunks"
        },
        "options": {
          "queryName": "match_documents"
        }
      },
      "id": "6195aeb8-4a27-408d-92fa-6bc3fad9f538",
      "name": "Supabase Vector Store",
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1,
      "position": [
        1240,
        40
      ]
    },
    {
      "parameters": {
        "fieldsToSummarize": {
          "values": [
            {
              "aggregation": "concatenate",
              "field": "data"
            }
          ]
        },
        "options": {}
      },
      "id": "3b91e3a2-aa4f-483c-aa22-7ef94d3e497a",
      "name": "Summarize #1",
      "type": "n8n-nodes-base.summarize",
      "typeVersion": 1,
      "position": [
        1260,
        1420
      ]
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "id": "574aec26-8d45-4c63-9480-d11b6993a7bc",
      "name": "Aggregate #1",
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        920,
        1420
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://www.googleapis.com/drive/v3/files/{{ $json.file_id }}/copy",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googleDriveOAuth2Api",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "name",
              "value": "={{ $json.file_id }}"
            },
            {
              "name": "mimeType",
              "value": "application/vnd.google-apps.document"
            }
          ]
        },
        "options": {}
      },
      "id": "88ceb972-32e2-430f-af20-25c431bfd11c",
      "name": "Convertir a Doc",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        280,
        640
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://www.googleapis.com/drive/v3/files/{{ $json.file_id }}/copy",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googleDriveOAuth2Api",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "name",
              "value": "={{ $json.file_id }}"
            },
            {
              "name": "mimeType",
              "value": "application/vnd.google-apps.document"
            }
          ]
        },
        "options": {}
      },
      "id": "d15f83f5-5429-460c-a3db-ef8d959ec36d",
      "name": "Convertir a Doc #1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        620,
        1740
      ]
    },
    {
      "parameters": {
        "content": "## Tres reglas de oro para que la película salga bien 🎬\nElige chunk size ≈ 500-1 000 caracteres y un overlap del 10-20 % si vas a responder preguntas.\n\nPon metadatos útiles en el Loader (título, URL, sección) para que luego puedas citar la fuente o filtrar resultados.\n\nAjusta separadores si tu contenido tiene estructura especial (Markdown, código, transcripciones con timestamps).",
        "height": 340,
        "width": 460
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1940,
        140
      ],
      "id": "ad7bdefb-8568-42c9-9f9c-1bf014c045cc",
      "name": "Sticky Note11"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [
    {
      "createdAt": "2025-07-09T17:48:27.405Z",
      "updatedAt": "2025-07-09T17:48:27.405Z",
      "id": "Fjfc4tKSdaKUsmPc",
      "name": "Pau Berenguer"
    }
  ],
  "triggerCount": 0,
  "updatedAt": "2025-07-10T00:00:11.534Z",
  "versionId": "056d9950-79b5-4475-8545-b49d8ad54ef9"
}