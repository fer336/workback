{
  "active": true,
  "connections": {
    "Form Me1": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [],
        [
          {
            "node": "vars",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [],
        [],
        [
          {
            "node": "base64",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "Reaction1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "vars": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to File1": {
      "main": [
        [
          {
            "node": "Transcribir1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Datos": {
      "main": [
        [
          {
            "node": "Form Me1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "base64": {
      "main": [
        [
          {
            "node": "Convert to File1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transcribir1": {
      "main": [
        [
          {
            "node": "msg reply",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        []
      ]
    },
    "msg reply": {
      "main": [
        [
          {
            "node": "Wait1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Reaction": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait1": {
      "main": [
        [
          {
            "node": "Reaction",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-03-05T05:12:22.205Z",
  "id": "VX0fSdLDY2fqWYxg",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "TRANSCRIPCION AUDIOS - FER",
  "nodes": [
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "94746291-c0f3-44f3-b635-1fe696d7d74e",
              "leftValue": "={{ $json.body.data.key.fromMe }}",
              "rightValue": "false",
              "operator": {
                "type": "boolean",
                "operation": "false",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "5dbcfd2a-3514-413e-a523-202a581b8d5d",
      "name": "Form Me1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -760,
        40
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "41aafda0-2ad8-4a37-b160-1e7255bc75d5",
              "leftValue": "={{ $json.body.data.key.remoteJid.includes('@g.us')}}",
              "rightValue": "={{ $json.body.data.key.remoteJid.includes('@g.us')}}",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "99e5b734-b1d7-44c1-9923-ecbe69a76624",
      "name": "If1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -560,
        40
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "60065893-74f7-4b64-bc1a-d891202efa78",
                    "leftValue": "={{ $('Datos').item.json.body.data.messageType }}",
                    "rightValue": "imageMessage",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Imagem"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "0cb14635-2673-408e-86db-ce9e0373674b",
                    "leftValue": "={{ $('Datos').item.json.body.data.messageType }}",
                    "rightValue": "conversation",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Texto"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Datos').item.json.body.data.messageType }}",
                    "rightValue": "audioMessage",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "900368e1-63d9-419c-9dd3-20cd105a527d"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "√Åudio"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "eafea61d-45c4-4eb7-b7e5-ee91c4a6bfb9",
                    "leftValue": "={{ $json.msg.type }}",
                    "rightValue": "call",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "call"
            }
          ]
        },
        "options": {}
      },
      "id": "5e7fd8ee-dab5-4f2f-a151-cf4e6fae765b",
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -120,
        -100
      ]
    },
    {
      "parameters": {
        "amount": 3
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -60,
        300
      ],
      "id": "c2a9eae0-2733-4110-8062-08c93b83a9a6",
      "name": "Wait",
      "webhookId": "c5753ffd-3ac8-4fe0-a888-9999f106031b"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "56ef887f-a0eb-415a-b841-44fd8b61b1a8",
              "name": "msg.id",
              "value": "={{ $('Datos').item?.json?.body?.data?.messageId || $json.body.data['0'].id}}",
              "type": "string"
            },
            {
              "id": "740549d1-2ed9-49fd-9969-f3f69c5a8df2",
              "name": "msg.telefono",
              "value": "={{ $('Datos').item?.json?.body?.data?.key?.remoteJid || $json.body.data['0'].chatId}}",
              "type": "string"
            },
            {
              "id": "74a49e3c-159b-47a2-ae8b-54924cef3965",
              "name": "msg.type",
              "value": "={{ $('Datos').item?.json?.body?.data?.messageType || $json.body.type }}",
              "type": "string"
            },
            {
              "id": "1c6e95f3-9a56-4d4c-8db0-ffd1a56664f2",
              "name": "msg.audio",
              "value": "={{ ($json.body.data.fileBase64 || '').substring(($json.body.data.fileBase64 || '').indexOf(',') + 1) }}",
              "type": "string"
            },
            {
              "id": "6900b05f-3f95-479a-a763-2fbb75de7603",
              "name": "msg.status",
              "value": "={{ $json.body.data['0'].status }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -340,
        40
      ],
      "id": "1afa928e-e7af-40f3-8d6b-31f4dbb3e3eb",
      "name": "vars"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://us.api-wa.me/2522xaf8359c21b/message/text",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "accept",
              "value": "*/*"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "to",
              "value": "={{ $('vars').item.json.msg.telefono }}"
            },
            {
              "name": "text",
              "value": "={{ $json.text }}"
            },
            {
              "name": "msgId",
              "value": "={{ $('vars').item.json.msg.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1260,
        -580
      ],
      "id": "33bd50d3-fce2-4f82-9879-c8189527dd2c",
      "name": "HTTP Request1"
    },
    {
      "parameters": {
        "resource": "audio",
        "operation": "transcribe",
        "options": {
          "language": "es",
          "temperature": 0.3
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        -960,
        300
      ],
      "id": "bd40a637-d71a-41ab-8c53-19b609c45710",
      "name": "Transcribir1",
      "credentials": {
        "openAiApi": {
          "id": "UfA35dBDzEebw8zR",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "options": {
          "fileName": "=audio.ogg"
        }
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        340,
        40
      ],
      "id": "f86fff9d-44fa-4d04-a75f-8d0ccce83dd9",
      "name": "Convert to File1"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "es-wa-fer",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1000,
        40
      ],
      "id": "4f3db7db-2940-458d-b71f-b8180b969860",
      "name": "Datos",
      "webhookId": "9ba09d30-2eb8-4bdf-8785-2bfc45e3f63d"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "b7d210f0-6a18-456d-9e89-aa28f548b2a0",
              "name": "base64",
              "value": "={{ $json.msg.audio }}",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "id": "91afc4c7-fb23-409e-8203-c35b50a2c3d5",
      "name": "base64",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        100,
        40
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://us.api-wa.me/2522xaf8359c21b/message/reaction",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "accept",
              "value": "*/*"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "to",
              "value": "={{ $('vars').item.json.msg.telefono }}"
            },
            {
              "name": "text",
              "value": "=‚úçÔ∏è"
            },
            {
              "name": "msgId",
              "value": "={{ $json.data.key.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -300,
        300
      ],
      "id": "13dc4c3b-332f-47da-a212-d639a4907c7c",
      "name": "Reaction"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://us.api-wa.me/2522xaf8359c21b/message/{{ $('vars').item.json.msg.id }}/text",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "accept",
              "value": "*/*"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "to",
              "value": "={{ $('vars').item.json.msg.telefono }}"
            },
            {
              "name": "text",
              "value": "=_Transcripci√≥n_ üí≠\n\n{{ $json.text }}"
            },
            {
              "name": "msgId",
              "value": "={{ $('vars').item.json.msg.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -760,
        300
      ],
      "id": "3213a2de-17e7-4b7f-b39a-62cfb72f0709",
      "name": "msg reply"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://us.api-wa.me/2522xaf8359c21b/message/reaction",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "accept",
              "value": "*/*"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "to",
              "value": "={{ $('vars').item.json.msg.telefono }}"
            },
            {
              "name": "text",
              "value": "=üéØ"
            },
            {
              "name": "msgId",
              "value": "={{ $json.data.message.reactionMessage.key.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        440,
        300
      ],
      "id": "43709ad0-49fd-468e-a46a-74030f297e73",
      "name": "Reaction1"
    },
    {
      "parameters": {
        "amount": 3
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -520,
        300
      ],
      "id": "912598b4-ddd0-426f-82ef-5debfeec2326",
      "name": "Wait1",
      "webhookId": "c5753ffd-3ac8-4fe0-a888-9999f106031b"
    }
  ],
  "pinData": {
    "Datos": [
      {
        "json": {
          "headers": {
            "host": "n8n.innovasoftpro.dev",
            "user-agent": "axios/1.8.4",
            "content-length": "278",
            "accept": "application/json, text/plain, */*",
            "accept-encoding": "gzip, compress, deflate, br",
            "content-type": "application/json",
            "instance-key": "2522xaf8359c21b",
            "x-forwarded-for": "144.126.133.227",
            "x-forwarded-host": "n8n.innovasoftpro.dev",
            "x-forwarded-port": "443",
            "x-forwarded-proto": "https",
            "x-forwarded-server": "575dad520f0e",
            "x-real-ip": "144.126.133.227"
          },
          "params": {},
          "query": {},
          "body": {
            "instance": "2522xaf8359c21b",
            "type": "call",
            "data": {
              "0": {
                "chatId": "5492254596618@s.whatsapp.net",
                "from": "5492254596618@s.whatsapp.net",
                "id": "61C2C478F8EA9CF37EDB797C30A10819",
                "date": "2025-06-16T19:07:18.000Z",
                "offline": false,
                "status": "ringing",
                "isVideo": false,
                "isGroup": false
              }
            }
          },
          "webhookUrl": "https://n8n.innovasoftpro.dev/webhook/es-wa-fer",
          "executionMode": "production"
        }
      }
    ]
  },
  "settings": {
    "executionOrder": "v1",
    "errorWorkflow": "2kOn0Oz7c2uvczPK"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2025-06-16T19:25:44.469Z",
  "versionId": "2aa2b27f-1171-4395-b3d5-76ea288eecdb"
}